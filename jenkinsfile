pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                docker.build("storybook_sb")
            }
        }
        stage('Test') {
            steps {
                sh 'npm test'
            }
        }
        stage('Deploy') {
            steps {
                // Se connecter à Heroku
                sh 'heroku login -i'
                
                // Ajouter le remote Heroku (si ce n'est pas déjà fait)
                //sh 'git remote add heroku https://git.heroku.com/mon-app-heroku.git'

                // Pousser sur Heroku pour déclencher le déploiement
                sh 'git push heroku master'

                // Vous pouvez aussi utiliser des commandes Heroku CLI pour gérer le déploiement
                // Par exemple, pour déployer un conteneur Docker sur Heroku :
                // sh 'heroku container:push web --app mon-app-heroku'
                // sh 'heroku container:release web --app mon-app-heroku'
            }
        }
    }
}
